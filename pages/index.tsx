import Head from 'next/head'
import { useRouter } from 'next/router'
import { useEffect, useState } from 'react'

const asciiBanner = [
  '++++++++++++**+++++*++++*++++**+++*++++*+++**+++*+++*+++*++++*+*+*++*#++++*+*+#++++*+++**+++**++++*++++++++',
  '++++++++++++++*+++++*++++*++*+*++++*+++**+*+*+++*+++*+++*++++*+*+*+++*+++**+++++++*++++*++++*++++**++++++++',
  '+++++++++*+++++**++++*++++**+++*+++**+++*++**+++*+++**++**++**+++*+++*+++*+++#++++*+++**+++*++++**+++**++++',
  '++++++++++**+++++**+++*++++*++++*+*+*+*++*+++*+++#+++*+++*++*+++**++*+++*+++*+++**+*+*++*+*++++*++++*+++++*',
  '++++++++++++**++*+*++++*++*+**+++*+++*+++*+*+*+*+*+++*+++*++*+++#+*+#+++#++***++*+++**+++*+++**+*++*++++**+',
  '+*+++++++++++**++++*++++**++*#+++**+++*+++*++*+++*+++*+++*++*+++%+++*++*+*+*+++**++**+++**++**+++**++++*+++',
  '++**+++++*+*++**+*++*++*+**+++*+++#+++**++#+++#+++*++*+++*++**+*#++*+++*+++*+++*++**++**+++**+++**++++**+++',
  '++++*+++++**++++**+++**+*+***++#+++#+++*+++#++**++#++**++#++#++**++#++**++#+++#+++#+++#*+++*+***++*+**+**+*',
  '++++++*+++++**+*+**+*++*+++**+++#+++#++***+#*++*++#*+**++*+*#++*+++#++#+++*+**++*#+++**++**+++*++++*+*++**+',
  '++++++++*+++++*++++**+++**++**++*#++**++*++*#**%**#%%%@%%@%#%++*++**++#++#+++#++**++#*+***+***+*+**++++*+++',
  '++****++++*++++**+++**+++**+++*+*+**+*#%%%+-                  .*@*#*+*#++*++**+**++#*++**++*++++**+++**+*++',
  '+++++**++++**++++**+++*+++**+***++#%%#      .              ....    %##*+#++**++#++***+**++**+++*++++#+*+***',
  '**+++++**++++**+++**+*+**+++#*+*%%=                      .........-**-*#**+#++**+**++*+++*+++**+++#++++**++',
  '++**++*++**++++**+++**++****+#%#                           ............:=%%++#*+**++#++*#+*+#+*+**+*+**++++',
  '++**+**+++***++++#*++*#*++#%@                                ............. +@#*+*++#++*#++*#+++**++*#+*+***',
  '**+++++**+++++*++++#+++*##%                                 ................. %%*+%++#+*+*+++**+++#+*++**++',
  '+++**++++***+*+**++++#*#%                            .       ................-==%%++#++**++*#+*+#*+++**+++*',
  '++++++**++++***++**+=#%.                            .          ............+...  *%#*+#*+*#*++**++*#++++***',
  '+*++*+++**++++**++++%*                             %              .  ........... .#%%%+***++**+++#++++**+++',
  '+*+*#+++++*#*+*++#*%                                             :#: .......--..*#. =%%%***#+++#*+*+#*+++**',
  '*+++++***+++**#*+*%                                            #.       .+...:*%%=.... +%%*+*#*++**+++****+',
  '++***++*++#*++++##                                           #.  .  %##%#@.....:....-+=-+%*#+++#*++**#++++*',
  '*++++*#*++*++#*#+  .                          .            #:   ..  .%+===...-:....+===-*%#+*%+++*#+*++##*+',
  '****+++++*#*++#+                               .         ::       .-%%====*..:+=:.#*%%%%%%%#+**#*++***++++*',
  '*+++****++++*%+                                :            =%%@%%%#+-==-+**:#  . %%@%@@%%%*#**++##+++**#*+',
  '**++++++*#**#-                                 .           +@==-=-==-+#%+=-=% *    -@%%%%@%*+*#*+++##*++++*',
  '+++**#*++++*:                                  .     -.   .%=-==*%%@#%%%%*+**% ...    .%##%#**+*##++++*##*+',
  '*++++++++*#:                                    . =   .-. :+*++%%%%%%%%%%%%%%% .   +. ::*.%%*#*+++*#*+++***',
  '++*****++*=                                 .    =*    ..:+%%%%%%%%%%%%%%%%%%%     #:*..# %%+*##*++***#**++',
  '+++++++++*                             ..   -    @    ...@%%%%%%%%%%%%%%%%%%%      :@@  *-:%#++*##*+++++*##',
  '++**##**%                  .            +   = . **  ...  #%%%%%%%%%%%%%%%%#%=  ... =%%%.=+: *%#+++*##**++++',
  '++++++++*                               :   :-..%+  . .   %%%%%%%%%%%%%%%%@   ..   #%%%% +.-..=%#*++****#**',
  '+++***#*%        .           .           #   #. %*  . ..   @%%%%@@%%%%%%%   ....  :%%%%%:-:.:..=%**++++++++',
  '**++++**%      :                         .%.:.= *%    ...  *  +%%#%#%%. . .       #%%%%%=-#+:-- %##%%#**+++',
  '++****##*                              .:. #..=-%#  .     .. .  ..      -*:+.     =%%%%%+-%::.. #*+********',
  '+++++*+%=                               .+..*=%%+           ..... .. .*:% .-       ##%%%.* *=  ..#+++++++++',
  '++++++*%:                       .        .% +%*                 ..   . .:   ....    .@%@# .+ #:  ###******+',
  '+++++++%:      .                .  .  ...  #%  ...                       .. ...            ... %##******+++',
  '+++++++%*                     .=+= . ... :%*  ..     .                   .                     .:*+++++++++',
  '+++++**#%.              .    .     *@%*%@+   . .   ..  .                         .             ...#********',
  '++++++++%%                                ....:+%@%- ......*@- .   .             ..         : .   %%#*+++++',
  '+++***###%%             .                *:...=............... .+.                  .      . .#   +++++*+++',
  '++++++++++%%             .       .     -::..:.-......................        - .... -#.+  #  * @   %+*#*#**',
  '*++**#****=#%:          @.         .  .. *...................................-....=-   +   %  * - : ##++++*',
  '++++++++++*#%%*         :%%::..   .:=*. .   *:........=@%@%@- .. ..:....-..   ==+  +  . # #%%#**##*++*++*#%',
  '+++*****+++++#%@           +***#%%%=  .     .*.......=%%%@%%%#%*+::- ...-.*-   %.   * .%-:-*+*##*+++*##**++',
  '**+++++++*#**+*%%          ..   ###%% *    . # ....*#+*%%%%%%%%%%%%%.-**.  . .  %*#=-::*=-:**#*++**#*++++**',
  '+++**#*++++++*#*#@.             .####% -   -  %#%+   =  =%%%%%%%%%%%    #  -==--:--:+%=-:-##**+*##*+++*#*++',
  '#*+++++***#*++++*#%-          .    #%  %:   :      .   : =%%%%%%%%%%@@ .% ::*-:---=%==*-=%#++*#*+*+*#*+*++*',
  '++++**#*++*+*****+*%:                  @                  @%%%%%%%%%%%%%%# :*:-----#::###*+*#*++*#*+*+***++',
  '***++++++***++++*#*##-    .....        #- .. .        .   @%%%%%%%%%%%%%%% :=%:----%-=#**+#*++***++****+++*',
  '++*++*#*+*+++*#++++##%* ...   .   . .  :#  ..         .  :%%%%%%%%%%%%%%%%:.--%:--:#:**+*#++*#+++*#+*++**++',
  '++***+++++#*++++**+++*#% ..%#@%:  .    .%# .           . +@%%%%%%%%%%%%%%@ .--#=---:#****+**+**#*+++#*++++*',
  '**++++***++++***+++**++*%%%*#*+*#@+=.:%+*%.:           . #%%%%%%%%%%%%%%%# .:-%=---###*+*#++***++**+++***++',
  '+++***++++***++++**+++#*++**++#+**#+**+**#@.            .@%%%%%%%%%%%%%%%% ..:%-::-%#+*#++*#+*+#+++*#++++*#',
  '***+++++**++++*#*+++#*++*#++#*++#*+**+**+%@.            .%%%%%%%%%%%%%%%%@  .:* +*-%+#++##*+#*++*#*+++#*+*+',
  '+*+++***+*++***++***++*#+++#++*#++#*+#***%* .            #%%%@%%%%%%%%%%%#:  :+-:.-#%*#*++#+++#*++*#+++***+',
  '+++**+*+++**+++**+++*#+++#*++#**+#++#*+#*@. ..         ...#%%%%%%%%%%%%%%%@  :::+  =.#@#*++#*++*#++++**+++*',
  '*++**++**+*++***+++#*++*#+*+#++***+#***+*% ...         .     ## +@@%%%%%%%%% ..:---* .#-%#+++#*++*#+++*#*+*',
  '+*+++**+*++**++++**+***+*+**++**++#*+**+#% ...             ..-.-  :.   =#%@@.:.:::-:*= .*#*#+**#+++*#+*++**',
  '+++**++++**++++**+++**+++#*+*#++*#++****#% ....             :....:+    %   -:..::.+  * +*%++**++**+++**++++',
  '***++++***+++**+++**+++**++*#+++#*+**++**%# ...            .....=. ....:..==    . +    *%#*++**+*+**+++**++',
  '+++++**++++**++*+**+++#*+***+*+#++**++#***%# ..            ....... ......=  ...:.: +=:-%%+**++**+*+**++++**',
  '++**+*++++*++*+**+++***++***+***+**+***+*#+%%- . .....      ............ .. ... .:..=.-%*+***+++**+*+**+*++',
  '**++++++**+++**+++***+++**++**++**+++*++*+++#%#*-       - ....   *.. .+*..........:...-%#*++**+++**++++**++',
  '++*+*+**++++**+++**+++***++**+*+*+++*++**++**+*#%%%#*.  %.    -%%.   %. #   ...........%***+++*++++*++++**+',
  '+++++*++++**++++**+++****+**+++#+++*+++#+++*++*+*+#**%%%%%-   *     . .       ... ....:%#+**+*+**+++**++++*',
  '+++**++++*+++++*+++++*+++**+++#++*#++**+*+#+++#++**++*++*##%%#+     .         ........ #%++**+*+**++++*++++',
  '*++++++*+++++**++++**+*+*++++*+++**+*+*+++*++**++*+*+*+*+++*##%%%+.            ...... %#+++**+++**++*+**++',
  '+++++**+++++**+++**+*++*+*++*++++*+++#+++#+++*+*+*+++*++**+**+++**#%@#%=          :  .@%+*+++**+++**+++++**',
  '+++++++*+++*++++**++++*++++*++++*+++*+++***++*+++#+++*++**++*+++**++*+*%%#@@##@%%%%%%%*++**+++**++++**++++*',
  '+++++++++++++++**++++**+++**+++*++++*+++*+++*+++*+*+**++**+++*++**+++**++****#*++*++++*+++**+++**+++++*++++',
  '++++++++++++++*+++++*+++***+++*+*++*+++**+++*+++*+++**++**+++*++**+++*+++#+++*++++**++**++++*+++**+++++++++',
  '+++++++++*+++*++++++++++*+++++*++**++++*+++*++++*++**+++*++++*+++*+++*+++*++++#++++*+++**++++*+++**+++++*++',
  '+++++++++++++++++++++++*+*++**++++*+++**++**+++**+++*+++*++++*+++*+++*++++*+++*++++*++*+**+++++++++++++++++',
  '++++++++++**++++++++++*+++++**+++#+*++*++++*+++*++++*+++*++++*+++*++*+++*+*++*+*++*+*++++*+++++*+++**+++++*',
  '+++++++++++++++++++++*+++++*++++**+++**+*+*++++*++++*+++*++++*+++**+++*++++*+++**++++++++++++++++++++++++++',
  '+++++++++++++++++++++*++++++++++*++++*++++*++++*++++*+++*++++*+++**+++*++++*++++*+++++*++++++++++++++++++++',
  '++++++++++++++++++++++++++++++++++++*++++++*+++++*+*++++*++++*++++*++*+*+++**++++++++++++++++++++++++++++++',
  '+++++++++++++++++++++++++++++++++++++++++*++++*++*+*++++*++++*++++*++*+*++++*++++++++++++++++++++++++++++++',
  '+++++++++++++++++++++++++++++++++++++++++**+++**+++*++++*++++*++++*++*+*++++*++++++++++++++++++++++++++++++',
]

export default function Landing() {
  const router = useRouter()
  const [displayLines, setDisplayLines] = useState(asciiBanner)
  const [isAnimating, setIsAnimating] = useState(false)

  useEffect(() => {
    if (!isAnimating) return
    if (typeof window === 'undefined') {
      router.push('/home')
      return
    }

    let working = asciiBanner.map((line) => line.split(''))
    const pool: Array<{ lineIndex: number; charIndex: number }> = []
    working.forEach((chars, lineIndex) => {
      chars.forEach((char, charIndex) => {
        if (char !== ' ') {
          pool.push({ lineIndex, charIndex })
        }
      })
    })

    let redirectTimeout: number | null = null

    const interval = window.setInterval(() => {
      if (pool.length === 0) {
        window.clearInterval(interval)
        setDisplayLines(working.map((chars) => chars.join('')))
        redirectTimeout = window.setTimeout(() => router.push('/home'), 200)
        return
      }

      const burstSize = Math.max(8, Math.floor(pool.length * 0.08))
      for (let i = 0; i < burstSize && pool.length > 0; i++) {
        const idx = Math.floor(Math.random() * pool.length)
        const { lineIndex, charIndex } = pool[idx]
        working[lineIndex][charIndex] = ' '
        pool.splice(idx, 1)
      }

      setDisplayLines(working.map((chars) => chars.join('')))
    }, 45)

    return () => {
      window.clearInterval(interval)
      if (redirectTimeout !== null) {
        window.clearTimeout(redirectTimeout)
      }
    }
  }, [isAnimating, router])

  const handleEnterPortal = () => {
    if (isAnimating) return
    setIsAnimating(true)
  }

  return (
    <div className="min-h-screen bg-black text-white">
      <Head>
        <title>Cyscom FFCS | Home</title>
      </Head>
      <div className="page-shell relative pb-14 md:pb-20">
        <div className="ascii-stack items-center text-center space-y-6">
          <header className="space-y-3">
            <p className="ascii-divider text-xs sm:text-sm md:text-base" aria-hidden="true">{'='.repeat(56)}</p>
            <h1 className="text-2xl sm:text-3xl md:text-4xl uppercase tracking-[0.28em] sm:tracking-[0.34em] md:tracking-[0.4em]">Cyscom FFCS</h1>
            <p className="text-[10px] sm:text-xs uppercase tracking-[0.12em] md:tracking-[0.16em] opacity-80">Campus Ops. Monochrome Mode.</p>
          </header>

          <section className="ascii-card inline-block max-w-full overflow-hidden">
            <span className="ascii-card-top" aria-hidden="true">+------------------------------+</span>
            <div className="px-4 sm:px-6 py-6 sm:py-8 space-y-6">
              <div className="space-y-1">
                {displayLines.slice(0, Math.floor(displayLines.length / 2)).map((line, index) => (
                  <pre
                    key={`top-${index}`}
                    className="text-[9px] xs:text-[10px] sm:text-[11px] md:text-xs whitespace-pre leading-4 transition-all duration-300 break-words"
                  >
                    {line}
                  </pre>
                ))}
              </div>
              <div className="space-y-2">
                <p className="text-[11px] sm:text-xs uppercase tracking-[0.14em] sm:tracking-[0.18em] opacity-80">
                  Welcome To The ASCII Vault
                </p>
                <button
                  type="button"
                  onClick={handleEnterPortal}
                  disabled={isAnimating}
                  className="ascii-button text-[11px] sm:text-xs mx-auto px-4 sm:px-6"
                >
                  {isAnimating ? 'Initializing Warp...' : 'Enter Portal'}
                </button>
                {isAnimating && <p className="ascii-footnote uppercase tracking-[0.16em]">Stand by. Collapse in progress.</p>}
              </div>
              <div className="space-y-1">
                {displayLines.slice(Math.floor(displayLines.length / 2)).map((line, index) => (
                  <pre
                    key={`bottom-${index}`}
                    className="text-[9px] xs:text-[10px] sm:text-[11px] md:text-xs whitespace-pre leading-4 transition-all duration-300 break-words"
                  >
                    {line}
                  </pre>
                ))}
              </div>
            </div>
            <span className="ascii-card-bottom" aria-hidden="true">+------------------------------+</span>
          </section>

          <section className="space-y-3 max-w-xl mx-auto">
            <h2 className="ascii-title">Playbook</h2>
            <hr className="ascii-rule" />
            <p className="text-sm leading-relaxed tracking-[0.06em] normal-case">
              Choose your battlestations, lock two departments, claim a project, and feed the contribution vault. Every action updates the grid.
            </p>
            <p className="ascii-footnote uppercase tracking-[0.18em] sm:tracking-[0.2em]">
              Trigger the blast whenever you are ready to breach.
            </p>
          </section>
        </div>
      </div>
    </div>
  )
}
